dependencies:

  cache_directories:
    - "~/.meteor"
    - "~/.npm"

  override:

    # -- CACHE METEOR --
    # Restore the meteor symlink
    - if [ -d ~/.meteor ]; then sudo ln -s ~/.meteor/meteor /usr/local/bin/meteor; fi
    # Install Meteor if the cache didn't restore it
    - if [ ! -e ~/.meteor/meteor ]; then curl https://install.meteor.com | sh; fi

    # -- CACHE CUCUMBER NPM MODULES --
    # Install package dependencies for Cucumber support files
    - npm install --production:
        pwd: tests/cucumber
          
    # -- INSTALL VELOCITY CLI --
    - npm install -g velocity-cli

    # -- INSTALL PHANTOM --
    - npm install -g phantomjs

test:

  override:

    - velocity test-app --ci:
        environment:
          SELENIUM_BROWSER: phantomjs
